\* UniqueReference.cfg - TLC Model Checker Configuration
\*
\* This configuration verifies that unique_references cannot be invalid
\* when the ref_owner owner follows the deletion protocol.

\* =============================================================================
\* Constants - Bounded for finite state exploration
\* =============================================================================

\* Three concurrent clients - enough to find race conditions
CONSTANT Clients = {1, 2, 3}

\* Each client can hold up to 2 refs - keeps state space manageable
CONSTANT MaxRefsPerClient = 2

\* =============================================================================
\* Specification
\* =============================================================================

\* Use the main spec where owner follows protocol
INIT Init
NEXT Next

\* =============================================================================
\* Safety Invariants to Check
\* =============================================================================

\* Main safety property: no use-after-free
INVARIANT NoUseAfterFree

\* No client holds ref to deleted object
INVARIANT ReferencesAlwaysValid

\* Cannot be deleted with outstanding refs
INVARIANT NoInvalidReference

\* Type correctness
INVARIANT TypeInvariant

\* Deletion requires marking first
INVARIANT DeletionImpliesMarked

\* Reference count consistency
INVARIANT RefCountMatchesClients

\* =============================================================================
\* Properties
\* =============================================================================

\* Check that the combined safety invariant holds
INVARIANT SafetyInvariant
